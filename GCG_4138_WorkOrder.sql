CREATE VIEW "GCG_4138_WorkOrder" AS SELECT "Job_Header" ."Job" ,"Job_Header" ."Suffix" ,"Job_Header" ."Part" ,"Job_Operations" ."Part" "Raw_Part" ,"Job_Header" ."Customer" ,"Job_Header" ."QTY_ORDER" ,IF ("SUBSTRING" ("Job_Header" ."DATE_DUE" ,5 ,2 )<= '99' AND "SUBSTRING" ("Job_Header" ."DATE_DUE" ,5 ,2 )>= '00' AND "SUBSTRING" ("Job_Header" ."DATE_DUE" ,1 ,2 )<= '12' AND "SUBSTRING" ("Job_Header" ."DATE_DUE" ,1 ,2 )>= '01' AND "SUBSTRING" ("Job_Header" ."DATE_DUE" ,3 ,2 )<= '31' AND "SUBSTRING" ("Job_Header" ."DATE_DUE" ,3 ,2 )>= '01' ,IF ("SUBSTRING" ("Job_Header" ."DATE_DUE" ,5 ,2 )< '80' ,"CONVERT" ('20' +"SUBSTRING" ("Job_Header" ."DATE_DUE" ,5 ,2 )+'-' +"SUBSTRING" ("Job_Header" ."DATE_DUE" ,1 ,2 )+'-' +"SUBSTRING" ("Job_Header" ."DATE_DUE" ,3 ,2 ),"SQL_DATE" ),"CONVERT" ('19' +"SUBSTRING" ("Job_Header" ."DATE_DUE" ,5 ,2 )+'-' +"SUBSTRING" ("Job_Header" ."DATE_DUE" ,1 ,2 )+'-' +"SUBSTRING" ("Job_Header" ."DATE_DUE" ,3 ,2 ),"SQL_DATE" )),"CONVERT" ('1900-01-01' ,"SQL_DATE" ))"DATE_DUE" ,"Job_Operations" ."HOURS_ESTIMATED" FROM "Job_Header" "Job_Header" LEFT JOIN "Job_Operations" "Job_Operations" ON "Job_Header" ."Job" = "Job_Operations" ."Job" WHERE "Job_Operations" ."LMO" = 'M' AND "Job_Operations" ."Part" <> '' AND "Job_Header" ."Flag_WO_Prtd" <> 'R' AND "Job_Operations" ."HOURS_ACTUAL" = 0.0000 